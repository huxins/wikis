(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{355:function(a,s,t){"use strict";t.r(s);var e=t(14),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"issues"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#issues"}},[a._v("#")]),a._v(" issues")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://blog.kelu.org/tech/2018/07/14/docker-restart-net-after-iptable-f.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("docker iptable 清空后如何重置容器网络"),s("OutboundLink")],1)])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# iptables -t nat -F")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 安装brctl")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" bridge-utils\nyum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" bridge-utils\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止docker服务")]),a._v("\nsystemctl stop "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 重建 docker 网络")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ifconfig")]),a._v(" docker0 down\nbrctl delbr docker0\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 重启docker服务")]),a._v("\nsystemctl start "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v("\n")])])]),s("ul",[s("li",[a._v("删除none镜像")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 删除容器")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" container "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" container "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-q")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("status")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("exited"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 删除镜像")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" image "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" image "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ls")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("dangling")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-q")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n")])])]),s("ul",[s("li",[a._v("配置文件")])]),a._v(" "),s("p",[s("a",{attrs:{href:"https://stackoverflow.com/questions/19335444/how-do-i-assign-a-port-mapping-to-an-existing-docker-container/",target:"_blank",rel:"noopener noreferrer"}},[a._v("修改已启动容器"),s("OutboundLink")],1)]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" /var/lib/docker/containers/容器ID/hostconfig.json\n")])])]),s("ul",[s("li",[a._v("磁盘占用与清理")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看空间占用细节")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" system "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("df")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 一并清除所有未被使用的镜像和悬空镜像")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" system prune "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 强制删除，不提示信息")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" system prune "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v("\n")])])]),s("h2",{attrs:{id:"dockerfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[a._v("#")]),a._v(" dockerfile")]),a._v(" "),s("h3",{attrs:{id:"copy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#copy"}},[a._v("#")]),a._v(" copy")]),a._v(" "),s("p",[a._v("通配符规则要满足 Go 的 "),s("a",{attrs:{href:"https://golang.org/pkg/path/filepath/#Match",target:"_blank",rel:"noopener noreferrer"}},[a._v("filepath.Match"),s("OutboundLink")],1),a._v(" 规则")]),a._v(" "),s("div",{staticClass:"language-dockerfile extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[s("code",[s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COPY")]),a._v(" package.json /mydir/")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COPY")]),a._v(" hom* /mydir/")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COPY")]),a._v(" hom?.txt /mydir/")]),a._v("\n")])])]),s("h3",{attrs:{id:"add"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#add"}},[a._v("#")]),a._v(" add")]),a._v(" "),s("h3",{attrs:{id:"cmd"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cmd"}},[a._v("#")]),a._v(" cmd")]),a._v(" "),s("div",{staticClass:"language-dockerfile extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# shell")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CMD")]),a._v(" top")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# exec")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token instruction"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CMD")]),a._v(" [ "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"top"')]),a._v(" ]")]),a._v("\n")])])]),s("h3",{attrs:{id:"entrypoint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#entrypoint"}},[a._v("#")]),a._v(" entrypoint")]),a._v(" "),s("p",[a._v("在运行时也可以替代，通过 "),s("code",[a._v("docker run")]),a._v(" 的参数 "),s("code",[a._v("--entrypoint")]),a._v(" 来指定")]),a._v(" "),s("h2",{attrs:{id:"compose"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compose"}},[a._v("#")]),a._v(" compose")]),a._v(" "),s("h3",{attrs:{id:"install"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#install"}},[a._v("#")]),a._v(" install")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-L")]),a._v(" https://github.com/docker/compose/releases/download/1.27.4/docker-compose-"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("uname")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("-"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("uname")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /usr/local/bin/docker-compose\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x /usr/local/bin/docker-compose\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# bash 补全命令")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-L")]),a._v(" https://raw.githubusercontent.com/docker/compose/1.27.4/contrib/completion/bash/docker-compose "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /etc/bash_completion.d/docker-compose\n")])])]),s("h3",{attrs:{id:"command"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#command"}},[a._v("#")]),a._v(" command")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://docs.docker.com/compose/startup-order/",target:"_blank",rel:"noopener noreferrer"}},[a._v("startup-order"),s("OutboundLink")],1)])]),a._v(" "),s("p",[a._v("options")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("-f, --file FILE")]),a._v(" 指定使用的 Compose 模板文件，默认为 docker-compose.yml，可以多次指定")]),a._v(" "),s("li",[s("code",[a._v("-p, --project-name NAME")]),a._v(" 指定项目名称，默认将使用所在目录名称作为项目名")]),a._v(" "),s("li",[s("code",[a._v("--x-networking")]),a._v(" 使用 Docker 的可拔插网络后端特性")]),a._v(" "),s("li",[s("code",[a._v("--x-network-driver DRIVER")]),a._v(" 指定网络后端的驱动，默认为 bridge")]),a._v(" "),s("li",[s("code",[a._v("--verbose")]),a._v(" 输出更多调试信息")]),a._v(" "),s("li",[s("code",[a._v("-v, --version")]),a._v(" 打印版本并退出")])]),a._v(" "),s("p",[a._v("command")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker-compose")]),a._v(" up\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker-compose")]),a._v(" down\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker-compose")]),a._v(" images\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);